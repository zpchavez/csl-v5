import{a as f,j as e,f as c,r as o,L as g,g as b,i as N}from"./index-C7YeYPMv.js";import{L as w}from"./LoadingIndicator-CfCaHdW_.js";import{b as v,B as _}from"./button-DoAC3Nwk.js";import{T as P,u as k}from"./TermLink-C2Dv_Lk7.js";import{m as y,t as R}from"./metadataClient-D2hMftnN.js";import{m as p,i as S}from"./metadataService-BYRtfFaS.js";import"./db-ClsXF1j4.js";const T=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],D=f("chevron-left",T);const L=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],C=f("chevron-right",L);const E=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],$=f("ellipsis",E);function z({className:t,...s}){return e.jsx("nav",{"aria-label":"pagination","data-slot":"pagination",className:c("mx-auto flex w-full justify-center",t),...s})}function B({className:t,...s}){return e.jsx("ul",{"data-slot":"pagination-content",className:c("flex flex-row items-center gap-1",t),...s})}function h({...t}){return e.jsx("li",{"data-slot":"pagination-item",...t})}function u({className:t,isActive:s,size:a="icon",...r}){return e.jsx("a",{"aria-current":s?"page":void 0,"data-slot":"pagination-link","data-active":s,className:c(v({variant:s?"outline":"ghost",size:a}),t),...r})}function G({className:t,...s}){return e.jsxs(u,{"aria-label":"Go to previous page",size:"default",className:c("gap-1 px-2.5 sm:pl-2.5",t),...s,children:[e.jsx(D,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function I({className:t,...s}){return e.jsxs(u,{"aria-label":"Go to next page",size:"default",className:c("gap-1 px-2.5 sm:pr-2.5",t),...s,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(C,{})]})}function F({className:t,...s}){return e.jsxs("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:c("flex size-9 items-center justify-center",t),...s,children:[e.jsx($,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]})}const U=10;function M({currentPage:t,totalPages:s}){const a=Math.max(t-5,1),r=Math.min(a+U-1,s),i=window.location.pathname,d=window.location.search,l=[];for(let n=a;n<=r;n++)l.push(n);const x=o.useCallback(n=>{const j=new URLSearchParams(d);return j.set("page",n.toString()),`${i}?${j.toString()}`},[i,d]);return s<=1?null:e.jsx(z,{children:e.jsxs(B,{children:[t>1&&e.jsx(h,{children:e.jsx(G,{href:x(t-1),children:"Previous"})}),l.map(n=>e.jsx(h,{children:n===t?e.jsx(u,{className:"bg-amber-200 cursor-default","aria-current":"page",children:n}):e.jsx(u,{href:x(n),children:n})},n)),s-r>0&&e.jsx(F,{}),t<s&&e.jsx(h,{children:e.jsx(I,{href:x(t+1),children:"Next"})})]})})}function O(t){const[s,a]=o.useState(null);return o.useEffect(()=>{async function r(){const i=await y.searchEpisodes(t);a(i)}r()},[t]),s}function A({episode:t,thumbnailDimensions:s}){return e.jsxs("div",{children:[e.jsx("div",{className:"text-center",children:t.title}),e.jsx("div",{className:"text-center",children:p.getDisplayDate(t.date)}),e.jsx(g,{to:"/display/$id",params:{id:String(t.episode_id)},children:e.jsx("img",{className:"mx-auto",src:S.getImageUrl({episode:t,size:"thumbnail"}),width:s?.width,height:s?.height,alt:`${t.title} ${p.getDisplayDate(t.date)}`})})]})}function H(t){const[s,a]=o.useState(null);return o.useEffect(()=>{async function r(){const i=await R.getTermDetails(t);a(i)}r()},[t]),s}const Q=t=>t.is_preferred===!0;function m({label:t,terms:s}){const a=s.filter(r=>!r.is_preferred||r.usageCount>0);return a.length===0?null:e.jsxs("div",{className:"flex p-4 border-b border-black",children:[e.jsx("div",{className:"w-1/4 text-center font-semibold",children:t}),e.jsx("div",{className:"flex-1",children:a.map((r,i)=>e.jsxs("span",{children:[Q(r)?e.jsx(P,{term:r}):r.term,i<s.length-1&&e.jsx("span",{children:", "})]},r.term_id))})]})}function V({termId:t}){const s=H(t);return s?e.jsxs("div",{className:"mx-auto w-3/4 border-black border bg-white pt-4",children:[e.jsx("div",{className:"text-center border-b border-black",children:e.jsx("h3",{children:s.term.term})}),"use_terms"in s?e.jsx(m,{label:"See",terms:s.use_terms}):null,"used_for_terms"in s?e.jsx(m,{label:"Used For",terms:s.used_for_terms}):null,"broader_terms"in s?e.jsx(m,{label:"Broader Terms",terms:s.broader_terms}):null,"narrower_terms"in s?e.jsx(m,{label:"Narrower Terms",terms:s.narrower_terms}):null,"related_terms"in s?e.jsx(m,{label:"Related Terms",terms:s.related_terms}):null]}):null}function W({query:t}){const s=O(t),a=b({from:"/browse/results"});o.useEffect(()=>{s&&Number(t.page)>s?.totalPages&&a({to:"/browse/results",search:{...t,page:String(s.totalPages)},replace:!0})},[s,t,a]);const{dimensions:r,isLoading:i}=k({episodes:s?.results,size:"thumbnail"}),d=t.search?"Search":"Browse";return e.jsxs("div",{className:"w-1/2 mx-auto",children:[e.jsxs("h2",{className:"text-center",children:[d," Results"]}),i?e.jsx(w,{}):e.jsxs(e.Fragment,{children:[t.term?e.jsx(V,{termId:Number(t.term)}):null,s?.totalCount===0&&e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("p",{className:"text-center mb-4",children:"No results found"}),e.jsx(_,{variant:"default",asChild:!0,children:e.jsx(g,{to:"/browse",children:"Revise browse criteria"})})]}),e.jsx("div",{className:"flex flex-wrap gap-4 justify-center mt-12 w-full",children:s?.results.map(l=>e.jsx(A,{episode:l,thumbnailDimensions:r[l.episode_id]},l.episode_id))}),s&&e.jsx("div",{className:"mt-8",children:e.jsx(M,{currentPage:s.currentPage,totalPages:s.totalPages})})]})]})}function se(){const t=N.useSearch();return e.jsx(W,{query:t})}export{se as component};
