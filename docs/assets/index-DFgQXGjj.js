import{r as n,j as e,L as c}from"./index-0pyO0dqw.js";import{m as r,i as d}from"./metadataService-OfZs_ozc.js";import{m as o}from"./metadataClient-BAflpM2N.js";import{d as l}from"./db-C1-VNlwc.js";import{L as m}from"./LoadingIndicator-Br7rzK0q.js";const u={async fetchLatestNews(){const s=l.prepare("SELECT * FROM news WHERE deleted = 0 ORDER BY date DESC"),t=[];for(;s.step();){const a=s.getAsObject();t.push({post_id:a.post_id,heading:a.heading,date:new Date(a.date),post:a.post})}return s.free(),t}};function x(){const[s,t]=n.useState([]);return n.useEffect(()=>{async function a(){const i=await u.fetchLatestNews();t(i)}a()},[]),s}function p(){const[s,t]=n.useState([]);return n.useEffect(()=>{async function a(){const i=await o.getLatestUploadedEpisodes();t(i)}a()},[]),s}function h(){const s=p();return e.jsxs("div",{children:[e.jsx("h2",{className:"text-center",children:"Latest Comics"}),s?.map(t=>e.jsx("div",{className:"mb-8",children:e.jsx(c,{to:"/display/$id",params:{id:String(t.episode_id)},children:e.jsx("img",{className:"mx-auto",src:d.getImageUrl({episode:t,size:"thumbnail"}),alt:`${t.title} ${r.getDisplayDate(t.date)}`})})},t.episode_id))]})}function f({post:s}){return e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{children:s.heading}),e.jsx("h4",{children:s.date.toISOString().substring(0,10)}),e.jsx("div",{className:"post",dangerouslySetInnerHTML:{__html:s.post}})]},s.post_id)}function j(){const s=x();return e.jsxs("div",{children:[e.jsx("h2",{className:"text-center",children:"Site News"}),e.jsx("div",{className:"ml-16 mr-16 w-1/2",children:s?s.map(t=>e.jsx(f,{post:t},t.post_id)):e.jsx(m,{})})]})}function w(){return e.jsx("div",{className:"news-page flex justify-center",children:e.jsxs("div",{className:"flex w-1/2 max-w-4xl",children:[e.jsx("div",{className:"w-3/4 pr-4",children:e.jsx(j,{})}),e.jsx("div",{className:"w-1/4 pl-4",children:e.jsx(h,{})})]})})}function S(){return e.jsx(w,{})}export{S as component};
